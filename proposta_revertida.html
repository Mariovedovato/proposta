<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposta Técnica</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Estilos adicionais para garantir que o modal seja exibido corretamente */
        .fixed.inset-0 {
            z-index: 9999; /* Garante que o modal esteja acima de tudo */
        }
        /* A mídia de impressão foi removida para restaurar a funcionalidade de PDF */
    </style>
    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- html2canvas CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- jsPDF CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/javascript">
        // Função para formatar CNPJ/CPF e limitar a entrada
        const formatCnpjCpf = (value) => {
            if (!value) return '';
            let cleanedValue = value.replace(/\D/g, '');
            cleanedValue = cleanedValue.substring(0, 14);

            if (cleanedValue.length <= 11) {
                return cleanedValue
                    .replace(/(\d{3})(\d)/, '$1.$2')
                    .replace(/(\d{3})(\d)/, '$1.$2')
                    .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            } else {
                return cleanedValue
                    .replace(/^(\d{2})(\d)/, '$1.$2')
                    .replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3')
                    .replace(/\.(\d{3})(\d)/, '.$1/$2')
                    .replace(/(\d{4})(\d)/, '$1-$2');
            }
        };

        // Função para formatar valor monetário para exibição final (sempre 2 decimais, separador de milhares)
        const formatCurrencyDisplay = (num) => {
            let numericValue = typeof num === 'string' ? parseFloat(num.replace(/\./g, '').replace(',', '.')) : num;
            if (isNaN(numericValue)) {
                return '0,00';
            }
            return new Intl.NumberFormat('pt-BR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(numericValue);
        };

        // Função para formatar a validade da proposta (apenas 2 dígitos numéricos)
        const formatTwoDigitNumberInput = (value) => {
            const cleanedValue = value.replace(/\D/g, ''); // Remove tudo que não é dígito
            return cleanedValue.substring(0, 2); // Limita a 2 dígitos
        };

        // Componente Modal de Entrada Genérico (para texto e CNPJ/CPF)
        const InputModal = ({ isOpen, onClose, title, value, onSave, type = 'text', formatFn = null }) => {
            const [inputValue, setInputValue] = React.useState(value);
            const inputRef = React.useRef(null);

            React.useEffect(() => {
                if (isOpen && inputRef.current) {
                    inputRef.current.focus();
                    // Se o valor inicial contém texto descritivo (ex: "10 dias úteis."), extrair apenas o número
                    if (title === "VALIDADE DA PROPOSTA") {
                        const numMatch = value.match(/^(\d+)/);
                        setInputValue(numMatch ? numMatch[1] : '');
                    } else {
                        setInputValue(value);
                    }
                }
            }, [isOpen, value, title]);

            const handleChange = (e) => {
                let newValue = e.target.value;
                if (formatFn) {
                    newValue = formatFn(newValue);
                }
                setInputValue(newValue.toUpperCase()); // Sempre caixa alta para estes campos
            };

            if (!isOpen) return null;

            return React.createElement(
                "div",
                { className: "fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4" },
                React.createElement(
                    "div",
                    { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-sm" },
                    React.createElement(
                        "h3",
                        { className: "text-lg font-semibold mb-4 text-gray-800" },
                        title
                    ),
                    React.createElement("input", {
                        ref: inputRef,
                        type: type,
                        className: "w-full p-3 border border-gray-300 rounded-md mb-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200",
                        value: inputValue,
                        onChange: handleChange,
                        placeholder: `Digite o ${title.toLowerCase()}`
                    }),
                    React.createElement(
                        "div",
                        { className: "flex justify-end space-x-3" },
                        React.createElement(
                            "button",
                            {
                                onClick: onClose,
                                className: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-200 font-medium"
                            },
                            "Cancelar"
                        ),
                        React.createElement(
                            "button",
                            {
                                onClick: () => {
                                    onSave(inputValue);
                                    onClose();
                                },
                                className: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200 font-medium shadow-md"
                            },
                            "Salvar"
                        )
                    )
                )
            );
        };

        // Componente para seleção de observações
        const ObservationSelectModal = ({ isOpen, onClose, title, options, onSelect }) => {
            if (!isOpen) return null;

            return React.createElement(
                "div",
                { className: "fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4" },
                React.createElement(
                    "div",
                    { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-sm" },
                    React.createElement(
                        "h3",
                        { className: "text-lg font-semibold mb-4 text-gray-800" },
                        title
                    ),
                    React.createElement(
                        "div",
                        { className: "flex flex-col space-y-3" },
                        options.map((option, index) =>
                            React.createElement(
                                "button",
                                {
                                    key: index,
                                    onClick: () => {
                                        onSelect(option);
                                        onClose();
                                    },
                                    className: "px-4 py-2 text-left bg-gray-100 text-gray-800 rounded-md hover:bg-blue-100 hover:text-blue-700 transition duration-200 font-medium border border-gray-200"
                                },
                                option
                            )
                        )
                    ),
                    React.createElement(
                        "div",
                        { className: "flex justify-end mt-4" },
                        React.createElement(
                            "button",
                            {
                                onClick: onClose,
                                className: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-200 font-medium"
                            },
                            "Fechar"
                        )
                    )
                )
            );
        };

        // Componente para seleção de descrição de serviço (agora usado para a tabela de valores estimados)
        const ServiceDescriptionSelectModal = ({ isOpen, onClose, title, options, onSelect }) => {
            if (!isOpen) return null;

            return React.createElement(
                "div",
                { className: "fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4" },
                React.createElement(
                    "div",
                    { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-md" },
                    React.createElement(
                        "h3",
                        { className: "text-lg font-semibold mb-4 text-gray-800" },
                        title
                    ),
                    React.createElement(
                        "div",
                        { className: "flex flex-col space-y-3" },
                        options.map((option, index) =>
                            React.createElement(
                                "button",
                                {
                                    key: index,
                                    onClick: () => {
                                        onSelect(option);
                                        onClose();
                                    },
                                    className: "px-4 py-2 text-left bg-gray-100 text-gray-800 rounded-md hover:bg-blue-100 hover:text-blue-700 transition duration-200 font-medium border border-gray-200"
                                },
                                option
                            )
                        )
                    ),
                    React.createElement(
                        "div",
                        { className: "flex justify-end mt-4" },
                        React.createElement(
                            "button",
                            {
                                onClick: onClose,
                                className: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-200 font-medium"
                            },
                            "Fechar"
                        )
                    )
                )
            );
        };

        // Novo componente para editar o valor e o tipo do valor
        const ValueEditModal = ({ isOpen, onClose, title, currentAmount, currentType, onSave }) => { // Adicionado 'title' aqui
            const [rawAmount, setRawAmount] = React.useState(''); // Stores only the digits typed by the user
            const [tempType, setTempType] = React.useState(currentType);
            const inputRef = React.useRef(null);

            // Helper function to format raw digits for display during typing (no decimals, only thousands separators)
            const formatValueForTypingDisplay = (digits, type) => {
                if (digits === '') return '';

                let numericValue = parseInt(digits, 10);
                if (isNaN(numericValue)) {
                    numericValue = 0;
                }

                // Apply numeric limits
                if (type === 'Hora') {
                    const maxHora = 1000;
                    if (numericValue > maxHora) {
                        numericValue = maxHora;
                    }
                } else { // type === 'Pacote'
                    const maxPacote = 1000000;
                    if (numericValue > maxPacote) {
                        numericValue = maxPacote;
                    }
                }

                // Format only the integer part with thousands separators
                return new Intl.NumberFormat('pt-BR', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(numericValue);
            };

            // Effect to reset state when modal opens or type changes, and set focus/cursor
            React.useEffect(() => {
                if (isOpen) {
                    setTempType(currentType);
                    // When opening, initialize rawAmount from currentAmount (remove formatting and decimals)
                    // Example: "160,00" -> "160"
                    const initialRaw = currentAmount.replace(/\D/g, '').slice(0, -2); // Remove non-digits, then remove last two (decimals)
                    setRawAmount(initialRaw);

                    if (inputRef.current) {
                        inputRef.current.focus();
                        // Set cursor to the end after initial render/focus
                        const currentDisplayedValue = formatValueForTypingDisplay(initialRaw, currentType);
                        inputRef.current.value = currentDisplayedValue; // Explicitly set value for cursor positioning
                        inputRef.current.selectionStart = currentDisplayedValue.length;
                        inputRef.current.selectionEnd = currentDisplayedValue.length;
                    }
                }
            }, [isOpen, currentAmount, currentType]);

            // Effect to maintain cursor position at the end after rawAmount changes (due to typing)
            React.useEffect(() => {
                if (inputRef.current && isOpen) {
                    const newFormattedValue = formatValueForTypingDisplay(rawAmount, tempType);
                    inputRef.current.value = newFormattedValue; // Manually set value to ensure cursor position works
                    inputRef.current.selectionStart = newFormattedValue.length;
                    inputRef.current.selectionEnd = newFormattedValue.length;
                }
            }, [rawAmount, tempType, isOpen]); // Added isOpen to dependencies to re-run when modal state changes

            const handleInputChange = (e) => {
                let newRawValue = e.target.value.replace(/\D/g, ''); // Keep only digits

                // Apply character length limit based on type for the raw input
                if (tempType === 'Hora') {
                    newRawValue = newRawValue.substring(0, 4); // Max 4 digits for "1000"
                } else { // Pacote
                    newRawValue = newRawValue.substring(0, 7); // Max 7 digits for "1000000"
                }
                setRawAmount(newRawValue);
            };

            const handleTypeChange = (newType) => {
                setTempType(newType);
                setRawAmount('');
            };

            const handleSave = () => {
                let numericValue = parseInt(rawAmount, 10) || 0;

                // Apply limits before final formatting
                if (tempType === 'Hora') {
                    const maxHora = 1000;
                    if (numericValue > maxHora) {
                        numericValue = maxHora;
                    }
                } else { // Pacote
                    const maxPacote = 1000000;
                    if (numericValue > maxPacote) {
                        numericValue = maxPacote;
                    }
                }

                // Use formatCurrencyDisplay for the final saved value (adds ,00)
                const valueToSave = formatCurrencyDisplay(numericValue);
                onSave(valueToSave, tempType);
                onClose(); // This should definitely close the modal
            };

            const inputMaxLength = tempType === 'Hora' ? 4 : 7;

            return React.createElement(
                "div",
                { className: "fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4", style: { display: isOpen ? 'flex' : 'none' } },
                React.createElement(
                    "div",
                    { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-sm" },
                    React.createElement(
                        "h3",
                        { className: "text-lg font-semibold mb-4 text-gray-800" },
                        title // 'title' agora está disponível aqui
                    ),
                    React.createElement(
                        "div",
                        { className: "mb-4" },
                        React.createElement(
                            "label",
                            { className: "block text-gray-700 text-sm font-bold mb-2" },
                            "TIPO DE VALOR:"
                        ),
                        React.createElement(
                            "div",
                            { className: "flex space-x-4" },
                            React.createElement(
                                "label",
                                { className: "inline-flex items-center" },
                                React.createElement("input", {
                                    type: "radio",
                                    className: "form-radio text-blue-600",
                                    name: "valueType",
                                    value: "Hora",
                                    checked: tempType === 'Hora',
                                    onChange: () => handleTypeChange('Hora')
                                }),
                                React.createElement(
                                    "span",
                                    { className: "ml-2 text-gray-700" },
                                    "Hora"
                                )
                            ),
                            React.createElement(
                                "label",
                                { className: "inline-flex items-center" },
                                React.createElement("input", {
                                    type: "radio",
                                    className: "form-radio text-blue-600",
                                    name: "valueType",
                                    value: "Pacote",
                                    checked: tempType === 'Pacote',
                                    onChange: () => handleTypeChange('Pacote')
                                }),
                                React.createElement(
                                    "span",
                                    { className: "ml-2 text-gray-700" },
                                    "Pacote"
                                )
                            )
                        )
                    ),
                    React.createElement(
                        "div",
                        { className: "mb-4" },
                        React.createElement(
                            "label",
                            { className: "block text-gray-700 text-sm font-bold mb-2" },
                            "VALOR (R$):"
                        ),
                        React.createElement("input", {
                            ref: inputRef,
                            type: "tel",
                            className: "w-full p-3 border border-gray-300 rounded-md mb-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200",
                            onChange: handleInputChange,
                            placeholder: "Digite o valor",
                            maxLength: inputMaxLength
                        })
                    ),
                    React.createElement(
                        "div",
                        { className: "flex justify-end space-x-3" },
                        React.createElement(
                            "button",
                            {
                                onClick: onClose,
                                className: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-200 font-medium"
                            },
                            "Cancelar"
                        ),
                        React.createElement(
                            "button",
                            {
                                onClick: handleSave,
                                className: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200 font-medium shadow-md"
                            },
                            "Salvar"
                        )
                    )
                )
            );
        };

        // Novo componente para editar a forma de pagamento
        const PaymentMethodEditModal = ({ isOpen, onClose, currentPaymentMethod, onSave }) => {
            // Extrai o valor antecipado da string atual
            const parsePaymentMethod = (methodString) => {
                const regex = /(\d+)% antecipado, (\d+)% na entrega./;
                const match = methodString.match(regex);
                if (match) {
                    return {
                        antecipado: match[1],
                        entrega: match[2], // Manter para inicialização, mas não será editável
                    };
                }
                return { antecipado: '50', entrega: '50' }; // Valores padrão se não conseguir parsear
            };

            const [tempPercentages, setTempPercentages] = React.useState(parsePaymentMethod(currentPaymentMethod));
            const inputRefAntecipado = React.useRef(null);

            React.useEffect(() => {
                if (isOpen && inputRefAntecipado.current) {
                    inputRefAntecipado.current.focus();
                    setTempPercentages(parsePaymentMethod(currentPaymentMethod)); // Atualiza ao abrir
                }
            }, [isOpen, currentPaymentMethod]);

            const handleChangeAntecipado = (e) => {
                const value = e.target.value.replace(/\D/g, ''); // Apenas dígitos
                const antecipadoNum = parseInt(value, 10) || 0;
                const entregaNum = 100 - antecipadoNum;

                setTempPercentages({
                    antecipado: value.substring(0, 2), // Limita a 2 dígitos
                    entrega: String(entregaNum),
                });
            };

            const handleSave = () => {
                const antecipado = tempPercentages.antecipado || '0';
                const entrega = tempPercentages.entrega || '0'; // Já está calculado
                const newPaymentMethod = `${antecipado}% antecipado, ${entrega}% na entrega.`;
                onSave(newPaymentMethod);
                onClose();
            };

            if (!isOpen) return null;

            return React.createElement(
                "div",
                { className: "fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4" },
                React.createElement(
                    "div",
                    { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-sm" },
                    React.createElement(
                        "h3",
                        { className: "text-lg font-semibold mb-4 text-gray-800" },
                        "EDITAR FORMA DE PAGAMENTO"
                    ),
                    React.createElement(
                        "div",
                        { className: "mb-4" },
                        React.createElement(
                            "label",
                            { className: "block text-gray-700 text-sm font-bold mb-2", htmlFor: "antecipado" },
                            "ANTECIPADO (%):"
                        ),
                        React.createElement("input", {
                            ref: inputRefAntecipado,
                            type: "tel",
                            id: "antecipado",
                            className: "w-full p-3 border border-gray-300 rounded-md mb-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200",
                            value: tempPercentages.antecipado,
                            onChange: handleChangeAntecipado,
                            placeholder: "Ex: 50",
                            maxLength: "2"
                        })
                    ),
                    React.createElement(
                        "div",
                        { className: "text-gray-700 text-sm mb-4" },
                        React.createElement(
                            "span",
                            { className: "font-bold" },
                            "NA ENTREGA (%):"
                        ),
                        " ",
                        tempPercentages.entrega,
                        "% (calculado automaticamente)"
                    ),
                    React.createElement(
                        "div",
                        { className: "flex justify-end space-x-3" },
                        React.createElement(
                            "button",
                            {
                                onClick: onClose,
                                className: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-200 font-medium"
                            },
                            "Cancelar"
                        ),
                        React.createElement(
                            "button",
                            {
                                onClick: handleSave,
                                className: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200 font-medium shadow-md"
                            },
                            "Salvar"
                        )
                    )
                )
            );
        };

        // Novo componente para editar o prazo de execução
        const ExecutionTimeEditModal = ({ isOpen, onClose, currentExecutionTime, onSave }) => {
            const [tempType, setTempType] = React.useState(currentExecutionTime.type);
            const [tempValue, setTempValue] = React.useState(currentExecutionTime.value);
            const inputRef = React.useRef(null);

            React.useEffect(() => {
                if (isOpen) {
                    setTempType(currentExecutionTime.type);
                    setTempValue(currentExecutionTime.value);
                    if (currentExecutionTime.type === 'dias' && inputRef.current) {
                        inputRef.current.focus();
                    }
                }
            }, [isOpen, currentExecutionTime]);

            const handleValueChange = (e) => {
                const cleanedValue = e.target.value.replace(/\D/g, '');
                setTempValue(cleanedValue.substring(0, 2)); // Limita a 2 dígitos
            };

            const handleSave = () => {
                onSave({ type: tempType, value: tempValue });
                onClose();
            };

            if (!isOpen) return null;

            return React.createElement(
                "div",
                { className: "fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 p-4" },
                React.createElement(
                    "div",
                    { className: "bg-white rounded-lg shadow-xl p-6 w-full max-w-sm" },
                    React.createElement(
                        "h3",
                        { className: "text-lg font-semibold mb-4 text-gray-800" },
                        "EDITAR PRAZO DE EXECUÇÃO"
                    ),
                    React.createElement(
                        "div",
                        { className: "mb-4" },
                        React.createElement(
                            "label",
                            { className: "block text-gray-700 text-sm font-bold mb-2" },
                            "TIPO DE PRAZO:"
                        ),
                        React.createElement(
                            "div",
                            { className: "flex flex-col space-y-2" },
                            React.createElement(
                                "label",
                                { className: "inline-flex items-center" },
                                React.createElement("input", {
                                    type: "radio",
                                    className: "form-radio text-blue-600",
                                    name: "executionType",
                                    value: "agendamento",
                                    checked: tempType === 'agendamento',
                                    onChange: () => {
                                        setTempType('agendamento');
                                        setTempValue('');
                                    }
                                }),
                                React.createElement(
                                    "span",
                                    { className: "ml-2 text-gray-700" },
                                    "Conforme agendamento"
                                )
                            ),
                            React.createElement(
                                "label",
                                { className: "inline-flex items-center" },
                                React.createElement("input", {
                                    type: "radio",
                                    className: "form-radio text-blue-600",
                                    name: "executionType",
                                    value: "dias",
                                    checked: tempType === 'dias',
                                    onChange: () => setTempType('dias')
                                }),
                                React.createElement(
                                    "span",
                                    { className: "ml-2 text-gray-700" },
                                    "Definir dias úteis"
                                )
                            )
                        )
                    ),
                    tempType === 'dias' && React.createElement(
                        "div",
                        { className: "mb-4" },
                        React.createElement(
                            "label",
                            { className: "block text-gray-700 text-sm font-bold mb-2" },
                            "NÚMERO DE DIAS ÚTEIS:"
                        ),
                        React.createElement("input", {
                            ref: inputRef,
                            type: "tel",
                            className: "w-full p-3 border border-gray-300 rounded-md mb-4 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-200",
                            value: tempValue,
                            onChange: handleValueChange,
                            placeholder: "Ex: 15",
                            maxLength: "2"
                        })
                    ),
                    React.createElement(
                        "div",
                        { className: "flex justify-end space-x-3" },
                        React.createElement(
                            "button",
                            {
                                onClick: onClose,
                                className: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-200 font-medium"
                            },
                            "Cancelar"
                        ),
                        React.createElement(
                            "button",
                            {
                                onClick: handleSave,
                                className: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200 font-medium shadow-md"
                            },
                            "Salvar"
                        )
                    )
                )
            );
        };

        // Componente principal do aplicativo
        function App() {
            // Estados para armazenar os dados do cliente
            const [clientName, setClientName] = React.useState('');
            const [clientCompany, setClientCompany] = React.useState('');
            const [clientDoc, setClientDoc] = React.useState('');
            const [clientContact, setClientContact] = React.useState('');
            // Estado para o valor da visita técnica e seu tipo
            const [visitValue, setVisitValue] = React.useState('160,00');
            const [visitValueType, setVisitValueType] = React.useState(''); // Novo estado para o tipo de valor

            // Novo estado para o texto da observação
            const [observationText, setObservationText] = React.useState('Valor para região de até 50 km');
            // Novo estado para a descrição do serviço selecionado na tabela de valores estimados
            const [selectedServiceInTable, setSelectedServiceInTable] = React.useState('Clique para selecionar o serviço');

            // Novo estado para a forma de pagamento
            const [paymentMethod, setPaymentMethod] = React.useState('50% antecipado, 50% na entrega.');
            // Novo estado para a validade da proposta
            const [proposalValidity, setProposalValidity] = React.useState('10 dias úteis.');
            // Novo estado para o prazo de execução
            const [executionTime, setExecutionTime] = React.useState({ type: 'agendamento', value: '' }); // Estado estruturado


            // Estados para controlar a visibilidade dos modais de entrada
            const [isClientNameModalOpen, setIsClientNameModalOpen] = React.useState(false);
            const [isClientCompanyModalOpen, setIsClientCompanyModalOpen] = React.useState(false);
            const [isClientDocModalOpen, setIsClientDocModalOpen] = React.useState(false);
            const [isClientContactModalOpen, setIsClientContactModalOpen] = React.useState(false);
            // Novo estado para controlar a visibilidade do modal do valor da visita
            const [isVisitValueEditModalOpen, setIsVisitValueEditModalOpen] = React.useState(false);

            // Novo estado para controlar a visibilidade do modal de observação
            const [isObservationModalOpen, setIsObservationModalOpen] = React.useState(false);
            // Novo estado para controlar a visibilidade do modal de descrição de serviço (agora para a tabela)
            const [isServiceDescriptionModalOpen, setIsServiceDescriptionModalOpen] = React.useState(false);
            // Novo estado para controlar a visibilidade do modal de forma de pagamento
            const [isPaymentMethodModalOpen, setIsPaymentMethodModalOpen] = React.useState(false);
            // Novo estado para controlar a visibilidade do modal de validade da proposta
            const [isProposalValidityModalOpen, setIsProposalValidityModalOpen] = React.useState(false);
            // Novo estado para controlar a visibilidade do modal de prazo de execução
            const [isExecutionTimeModalOpen, setIsExecutionTimeModalOpen] = React.useState(false);


            // Referência para o conteúdo da proposta para gerar o PDF
            const proposalRef = React.useRef(null);
            // Estado para controlar a exibição da mensagem de erro do PDF
            const [showPdfError, setShowPdfError] = React.useState(false);

            // Novo estado para controlar se as bibliotecas de PDF foram carregadas
            const [arePdfLibsLoaded, setArePdfLibsLoaded] = React.useState(false);

            // Efeito para verificar se as bibliotecas de PDF foram carregadas
            React.useEffect(() => {
                const checkLibraries = () => {
                    if (window.html2canvas && window.jsPDF) {
                        setArePdfLibsLoaded(true);
                        // console.log("html2canvas e jsPDF carregados com sucesso!"); // Para depuração
                    } else {
                        // console.log("Aguardando html2canvas e jsPDF..."); // Para depuração
                        setTimeout(checkLibraries, 100); // Tenta novamente após um pequeno atraso
                    }
                };
                checkLibraries();
            }, []); // Executa apenas uma vez após a montagem do componente


            // Função para gerar o PDF
            const generatePdf = () => {
                setShowPdfError(false); // Reset error on new attempt
                // Verifica se as bibliotecas estão disponíveis globalmente (carregadas via CDN)
                if (proposalRef.current && window.html2canvas && window.jsPDF) {
                    window.html2canvas(proposalRef.current, { scale: 2 }).then(canvas => {
                        const imgData = canvas.toDataURL('image/png');
                        // Instancia jsPDF a partir do objeto global window
                        const pdf = new window.jsPDF('p', 'mm', 'a4'); // 'p' para retrato, 'mm' para milímetros, 'a4' para tamanho A4
                        const imgWidth = 210; // Largura A4 em mm
                        const pageHeight = 297; // Altura A4 em mm
                        const imgHeight = canvas.height * imgWidth / canvas.width;
                        let heightLeft = imgHeight;
                        let position = 0;

                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;

                        while (heightLeft >= 0) {
                            position = heightLeft - imgData.height; // Ajuste para a altura real da imagem
                            pdf.addPage();
                            pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                            heightLeft -= pageHeight;
                        }
                        pdf.save('proposta-tecnica.pdf');
                    });
                } else {
                    console.error("As bibliotecas html2canvas ou jspdf não foram carregadas. Certifique-se de incluí-las via CDN no seu arquivo HTML.");
                    // setShowPdfError(true); // Removido, pois o botão estará desativado se as libs não estiverem prontas
                }
            };

            return React.createElement(
                "div",
                { className: "min-h-screen bg-gray-100 p-4 sm:p-6 lg:p-8 font-sans flex justify-center" },
                React.createElement(
                    "div",
                    { ref: proposalRef, className: "bg-white rounded-xl shadow-lg p-6 sm:p-8 lg:p-10 w-full max-w-4xl border border-gray-200 proposal-content-area" },
                    React.createElement(
                        "div",
                        { className: "flex justify-end mb-4 print-hidden" },
                        React.createElement(
                            "button",
                            {
                                onClick: generatePdf,
                                className: `px-6 py-3 bg-green-600 text-white rounded-lg transition duration-200 font-semibold shadow-md flex items-center space-x-2 ${!arePdfLibsLoaded ? 'opacity-50 cursor-not-allowed' : 'hover:bg-green-700'}`,
                                disabled: !arePdfLibsLoaded // Desabilita o botão se as libs não estiverem carregadas
                            },
                            React.createElement(
                                "svg",
                                { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor", strokeWidth: 2 },
                                React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" })
                            ),
                            React.createElement(
                                "span",
                                null,
                                arePdfLibsLoaded ? "Gerar PDF" : "Carregando PDF..." // Texto dinâmico
                            )
                        )
                    ),
                    showPdfError && React.createElement(
                        "div",
                        { className: "bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4", role: "alert" },
                        React.createElement(
                            "strong",
                            { className: "font-bold" },
                            "Erro ao gerar PDF:"
                        ),
                        React.createElement(
                            "span",
                            { className: "block sm:inline" },
                            " As bibliotecas html2canvas ou jspdf não foram carregadas. Por favor, certifique-se de que o arquivo HTML foi salvo e aberto diretamente no navegador do seu celular, e não através de um ambiente limitado."
                        )
                    ),
                    React.createElement(
                        "header",
                        { className: "mb-8 pb-6 border-b border-gray-200" },
                        React.createElement(
                            "h1",
                            { className: "text-3xl sm:text-4xl font-extrabold text-blue-700 mb-2 text-center" },
                            "PROPOSTA TÉCNICA ORÇAMENTO DE SERVIÇOS"
                        ),
                        React.createElement(
                            "p",
                            { className: "text-lg text-gray-700 mb-1" },
                            "Empresa: ",
                            React.createElement(
                                "span",
                                { className: "font-semibold" },
                                "Vamplas Máquinas & Consultoria"
                            )
                        ),
                        React.createElement(
                            "p",
                            { className: "text-lg text-gray-700 mb-1" },
                            "Responsável: ",
                            React.createElement(
                                "span",
                                { className: "font-semibold" },
                                "Mario Vedovato"
                            )
                        ),
                        React.createElement(
                            "p",
                            { className: "text-md text-gray-600 mb-1" },
                            "Especialista em Manutenção Industrial, Automação e Consultoria Técnica"
                        ),
                        React.createElement(
                            "p",
                            { className: "text-md text-gray-600" },
                            "Contato: ",
                            React.createElement(
                                "span",
                                { className: "font-semibold" },
                                "(19) 999 18-5624"
                            ),
                            " | E-mail: ",
                            React.createElement(
                                "span",
                                { className: "font-semibold" },
                                "vamplasmaquinas@gmail.com"
                            )
                        )
                    ),
                    React.createElement(
                        "section",
                        { className: "mb-8 p-6 bg-blue-50 rounded-lg border border-blue-200" },
                        React.createElement(
                            "h2",
                            { className: "text-xl sm:text-2xl font-bold text-blue-700 mb-4" },
                            "DADOS DO CLIENTE"
                        ),
                        React.createElement(
                            "div",
                            { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                            React.createElement(
                                "div",
                                { className: "flex flex-col" },
                                React.createElement(
                                    "label",
                                    { className: "text-gray-700 font-medium mb-1" },
                                    "CLIENTE:"
                                ),
                                React.createElement(
                                    "div",
                                    {
                                        className: "bg-white p-3 border border-gray-300 rounded-md cursor-pointer hover:border-blue-500 transition duration-200 flex items-center justify-between",
                                        onClick: () => setIsClientNameModalOpen(true)
                                    },
                                    React.createElement(
                                        "span",
                                        { className: "text-gray-800 flex-grow" },
                                        (clientName.toUpperCase() || 'Clique para adicionar o nome do cliente')
                                    ),
                                    React.createElement(
                                        "svg",
                                        { xmlns: "http://www.w3.org/2000/svg", className: "h-5 w-5 text-gray-400 ml-2", viewBox: "0 0 20 20", fill: "currentColor" },
                                        React.createElement("path", { d: "M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.38-2.827-2.828z" })
                                    )
                                ),
                                React.createElement(InputModal, {
                                    isOpen: isClientNameModalOpen,
                                    onClose: () => setIsClientNameModalOpen(false),
                                    title: "NOME DO CLIENTE",
                                    value: clientName,
                                    onSave: setClientName
                                })
                            ),
                            React.createElement(
                                "div",
                                { className: "flex flex-col" },
                                React.createElement(
                                    "label",
                                    { className: "text-gray-700 font-medium mb-1" },
                                    "EMPRESA:"
                                ),
                                React.createElement(
                                    "div",
                                    {
                                        className: "bg-white p-3 border border-gray-300 rounded-md cursor-pointer hover:border-blue-500 transition duration-200 flex items-center justify-between",
                                        onClick: () => setIsClientCompanyModalOpen(true)
                                    },
                                    React.createElement(
                                        "span",
                                        { className: "text-gray-800 flex-grow" },
                                        (clientCompany.toUpperCase() || 'Clique para adicionar o nome da empresa')
                                    ),
                                    React.createElement(
                                        "svg",
                                        { xmlns: "http://www.w3.org/2000/svg", className: "h-5 w-5 text-gray-400 ml-2", viewBox: "0 0 20 20", fill: "currentColor" },
                                        React.createElement("path", { d: "M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.38-2.827-2.828z" })
                                    )
                                ),
                                React.createElement(InputModal, {
                                    isOpen: isClientCompanyModalOpen,
                                    onClose: () => setIsClientCompanyModalOpen(false),
                                    title: "EMPRESA DO CLIENTE",
                                    value: clientCompany,
                                    onSave: setClientCompany
                                })
                            ),
                            React.createElement(
                                "div",
                                { className: "flex flex-col" },
                                React.createElement(
                                    "label",
                                    { className: "text-gray-700 font-medium mb-1" },
                                    "CNPJ/CPF:"
                                ),
                                React.createElement(
                                    "div",
                                    {
                                        className: "bg-white p-3 border border-gray-300 rounded-md cursor-pointer hover:border-blue-500 transition duration-200 flex items-center justify-between",
                                        onClick: () => setIsClientDocModalOpen(true)
                                    },
                                    React.createElement(
                                        "span",
                                        { className: "text-gray-800 flex-grow" },
                                        (clientDoc.toUpperCase() || 'Clique para adicionar o CNPJ/CPF')
                                    ),
                                    React.createElement(
                                        "svg",
                                        { xmlns: "http://www.w3.org/2000/svg", className: "h-5 w-5 text-gray-400 ml-2", viewBox: "0 0 20 20", fill: "currentColor" },
                                        React.createElement("path", { d: "M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 